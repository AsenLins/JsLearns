<!doctype html>
<html class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Auto Form</title>
  <meta name="description" content="表单生成">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <link rel="apple-touch-icon-precomposed" href="ui/assets/i/app-icon72x72@2x.png">
  <meta name="apple-mobile-web-app-title" content="Amaze UI" />
  <link rel="stylesheet" href="ui/assets/css/amazeui.min.css"/>
  <link rel="stylesheet" href="ui/assets/css/admin.css">

  <link rel="stylesheet" href="css/iconfont.css?v=1" />
  <style type="text/css">
    /*==========覆盖部分默认样式==========*/
    a{
      cursor: pointer;
    }

    html{
      width: 100%;
      height: 100%;
    }

    body{
      background-image: url('content/projectImage/bg.png');
      font-family: 微软雅黑;
    }

    .admin-sidebar{
      overflow: hidden;
    }

    .am-nav-tabs{
      margin-top: 0.6em;
      margin-left: 0.5em;
    }

    .am-topbar-customer{
      background-color: #ed2c33;
      border-color:#da1b22;
      color:#eee;
    }
    .admin-sidebar-list li div{
      display: block;
      padding: 1rem 0;
      cursor:pointer;
      color: #5c5c5c;
      padding-left: 24px;
    }

    *+.am-alert{
      margin: 0px;
    }

    /*==========拖拽面板样式==========*/
    .admin-content-body{
      background-color: #fafafa;
      height: 30%;

    }

    /*==========面板Size类型样式==========*/
    .formContent-default{
      width: 414px;
      height: 736px;
      border-radius: 0px;
      background-color: white;
      box-shadow: 0px 0px 22px -8px black;
      position:relative;

      overflow:auto;
      transition: all 0.5s;
      float:left;
      margin-top: 2em;
      margin-left: 2em;
    }

    .formLayoutType-select{
      margin-right: 2em;
    }

    .form-tip-group{
      display: table;
      text-align:center;
      font-size: 1.2em;
      color: #dfdfdf;
      height: 100%;
      width: 100%;
    }

    .form-tip{
      display:table-cell;
      vertical-align:middle;
      text-align:center;
    }

    .form-tip-border{
      border: 1px dashed #eeeeee;
      padding-top: 0.8em;
      padding-bottom: 0.8em;
      width:80%;
      margin-left: 10%;
    }

    .icon-tuodong{
      font-size: 1.0em;
    }



    /*面板类型选择*/
    .formLayoutType-plane{
      border-top:1px solid #ececec;
      border-bottom:1px solid #cccccc;
      height: 35px;
      font-size: 0.7em;
      margin-top: 0.3em;
      padding-left: 2em;
    }

    .formLayoutType-plane>div{
      display:inline-block;
      height: 100%;
      line-height: 35px;
    }

    .formLayoutType-select select{
      margin-bottom: 0.35em;
      font-weight: bold;
      width: 125px;
      text-align:center;
      border:1px solid #e6e6e6;
    }




    /*========表单控件样式========*/
    .am-form-custom{
      padding: 1em;
    }

    .am-form-custom button,
    .am-form-custom select,
    .am-form-custom textarea,
    .am-form-custom>div,
    .am-form-custom input{
      margin-bottom: 0.4em;
      margin: 0 0.1em 0.4em 0.1em;
      flex-grow: 1;
      flex-shrink:1;
      cursor: pointer;
    }

    .am-form-custom input{
      flex-basis: 15%;
    }

    .am-form-custom label{
      flex-grow: 0;
      flex-shrink:0;
      line-height: 35px;
      margin: 0 0.4em;
      color: #35495e;
      font-size: 0.9em;
      cursor: pointer;
    }

    /*========面板样式========*/

    /*行排列*/
    .am-form-custom .item-row{
      display:flex;
      flex-direction:row;
      justify-content:start;
      align-content:center;
      flex-wrap: wrap;
    }

    /*列排列*/
    .am-form-custom .item-colum{
      display:flex;
      flex-direction:column;
    }

    .am-form-custom .item-row,
    .am-form-custom .item-colum{
      margin-bottom: 1em;
      position:relative;
      top: 0px;
    }

    .am-form-custom .item-row::after,
    .am-form-custom .item-row::before{
      font-family:"iconfont" !important;
      font-size:16px;
      font-style:normal;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      position:absolute;
      color: #c3c3c3;
      top: -1px;
      left:4px;
      content: "\e6a8";
    }

    /*只有编辑模式才有的样式*/
    .am-form-custom .item-row,
    .am-form-custom .item-colum{
      margin-bottom: 1em;
      border:1px dashed #d2d2d2;
      padding: 1.3em 0.4em 1.3em 0.4em;
    }

    .item-option-colum{

    }

    /*form的属性面板*/

    .formOptionPlane{
      position: relative;
      top: 2em;
      left:1em;
      height: 80%;
      background-color:white;
      float:left;
      box-shadow: 0px 0px 20px -5px gray;
      padding: 1em;

    }
    .am-form-option{

    }
    .option-content{
      margin-top: 2em;
    }

    .am-form-option .item-option-row{
      display:flex;
      flex-direction:row;
      justify-content:start;
      align-content:center;
      flex-wrap: wrap;
      margin:0.8em auto;
    }

    .am-form-option .item-option-colum{
      display:flex;
      flex-direction:column;
      margin:1em auto;
    }

    .form-unclick{
      cursor:not-allowed;
      color:#cdcdcd;
    }
    .form-unclick:visited,
    .form-unclick:link,
    .form-unclick:focus,
    .form-unclick:active,
    .form-unclick:hover{
      color: #cdcdcd!important;
    }






  </style>
</head>
<body>

<header class="am-topbar am-topbar-customer admin-header">
  <div class="am-topbar-brand">
    <strong>Auto Form</strong> <small>表单生成器</small>
  </div>
</header>

<div id="autoForm" class="am-cf admin-main">

  <!-- sidebar start -->
  <div class="admin-sidebar am-offcanvas" id="admin-offcanvas">
    <div class="am-offcanvas-bar admin-offcanvas-bar">
      <ul class="am-list admin-sidebar-list">
      <li v-for="plane in formMap">
          <a  class="am-cf" data-am-collapse="{target: '#collapse-nav'}">
            <span :class="plane.icon"></span>
              {{plane.title}}
            <span class="am-icon-angle-right am-fr am-margin-right"></span>
          </a>
          <ul class="am-list am-collapse admin-sidebar-sub am-in">
              <li draggable="true" ondragstart="dragStart(event)"  v-for="menu in plane.controlMap">
                <div class="am-cf"><span :class="menu.icon"></span>
                  {{menu.title}}
                </div>
              </li>
          </ul>
      </li>

        <div class="am-panel am-panel-default admin-sidebar-panel">
          <div class="am-panel-bd">
            <p><span class="am-icon-bookmark"></span> 使用方法</p>
            <p>1.请先添加面板控件。</p>
            <p>2.再拖动表单控件。</p>
          </div>
        </div>
      </ul>

    </div>
  </div>
  <!-- sidebar end -->

<!-- content start -->
<div class="admin-content">

  <div class="admin-content-body">

    <div class="formLayoutType-plane" id="formLayoutType-plane">
      <div class="formLayoutType-select">
        <select v-model="layout.itemSelect" @change="layoutChange">
          <option  v-for="(sizeItem,key) in layout.layoutItems" :value="key" >{{key}}</option>
        </select>
      </div>
      <div class="formLayoutType-size">{{layout.currentSize.width}} * {{layout.currentSize.height}}</div>
    </div>

    <div class="am-alert am-alert-danger" style="display:none;">
      请不然要输出这样的值。
    </div>

    <div id="js-formDragPlane" ondragover="dropEventBus.dragOver(event)" ondrop="dropEventBus.dragEvent(event)" :style="layoutStyle" class="formContent-default" >

<form class="am-form-custom">

   <div draggable="true" ondragstart="dropEventBus.dragStart(event)" class="item-row">
       <label draggable="true" ondragstart="dropEventBus.dragStart(event)">密码邮件:</label>
       <input  type="email"  class="am-form-field" placeholder="电子邮件" data-form-un="1516000411279.6406">
       <label>-</label>
       <input  type="email" class="am-form-field" placeholder="电子邮件" data-form-un="1516000411279.6406">
       <label>-</label>
       <input  type="email" class="am-form-field" placeholder="电子邮件" data-form-un="1516000411279.6406">
   </div>

   <div class="item-row">
       <label>密码邮件:</label>
       <input  type="email"  class="am-form-field" placeholder="电子邮件" data-form-un="1516000411279.6406">
       <label>性别:</label>

       <select>
         <option value="">苹果</option>
         <option value="">香蕉</option>
         <option value="">橙子</option>
       </select>
   </div>

   <div class="item-colum">

   </div>

   <div class="item-row">
     <label>选择一样水果:</label>
     <label draggable="true" ondragstart="dropEventBus.dragStart(event)"><input draggable="true" ondragstart="dropEventBus.dragStart(event)" type="checkbox"> 苹果</label>
     <label draggable="true" ondragstart="dropEventBus.dragStart(event)"><input draggable="true" ondragstart="dropEventBus.dragStart(event)" type="checkbox"> 苹果</label>
     <label><input type="checkbox"> 香蕉</label>
     <label><input type="checkbox" value="cool"> 橙子</label>
     <label><input type="checkbox"> 橙子</label>
     <label><input type="checkbox"> 橙子</label>
   </div>

   <div class="item-row">
     <label>选择一样水果:</label>
     <label draggable="true" ondragstart="dropEventBus.dragStart(event)"><input draggable="true" ondragstart="dropEventBus.dragStart(event)" type="checkbox"> 苹果</label>
     <label draggable="true" ondragstart="dropEventBus.dragStart(event)"><input draggable="true" ondragstart="dropEventBus.dragStart(event)" type="checkbox"> 苹果</label>
     <label><input type="checkbox"> 香蕉</label>
     <label><input type="checkbox" value="cool"> 橙子</label>
     <label><input type="checkbox"> 橙子</label>
     <label><input type="checkbox"> 橙子</label>
   </div>

   <div class="item-row">
     <label>选择一样水果:</label>
     <label draggable="true" ondragstart="dropEventBus.dragStart(event)"><input draggable="true" ondragstart="dropEventBus.dragStart(event)" type="checkbox"> 苹果</label>
     <label draggable="true" ondragstart="dropEventBus.dragStart(event)"><input draggable="true" ondragstart="dropEventBus.dragStart(event)" type="checkbox"> 苹果</label>
     <label><input type="checkbox"> 香蕉</label>
     <label><input type="checkbox" value="cool"> 橙子</label>
     <label><input type="checkbox"> 橙子</label>
     <label><input type="checkbox"> 橙子</label>
   </div>


   <div class="item-row">
     <label>选择一样水果:</label>
     <label draggable="true" ondragstart="dropEventBus.dragStart(event)"><input draggable="true" ondragstart="dropEventBus.dragStart(event)" type="checkbox"> 苹果</label>
     <label draggable="true" ondragstart="dropEventBus.dragStart(event)"><input draggable="true" ondragstart="dropEventBus.dragStart(event)" type="checkbox"> 苹果</label>
     <label><input type="checkbox"> 香蕉</label>
     <label><input type="checkbox" value="cool"> 橙子</label>
     <label><input type="checkbox"> 橙子</label>
     <label><input type="checkbox"> 橙子</label>
   </div>


   <div class="item-row">
     <label>选择一样水果:</label>
     <label draggable="true" ondragstart="dropEventBus.dragStart(event)"><input draggable="true" ondragstart="dropEventBus.dragStart(event)" type="checkbox"> 苹果</label>
     <label draggable="true" ondragstart="dropEventBus.dragStart(event)"><input draggable="true" ondragstart="dropEventBus.dragStart(event)" type="checkbox"> 苹果</label>
     <label><input type="checkbox"> 香蕉</label>
     <label><input type="checkbox" value="cool"> 橙子</label>
     <label><input type="checkbox"> 橙子</label>
     <label><input type="checkbox"> 橙子</label>
   </div>




</form>
<!--
<form class="am-form-custom am-form-inline" role="form">
  <div class="am-form am-form-group">
      <label for="doc-ipt-pwd-2" >密码</label>
    <input type="email" class="am-form-field" placeholder="电子邮件" data-form-un="1516000411279.6406">
  </div>&nbsp;
  <div class="am-form-group">
    <label for="doc-ipt-pwd-2" >密码</label>
    <input type="password" class="am-form-field" placeholder="密码" data-form-pw="1516000411279.6406"></div>&nbsp;
  <div class="am-checkbox">

  <label>

    <input type="checkbox"> 记住我</label></div>&nbsp;
    <button type="submit" class="am-btn am-btn-default" data-form-sbm="1516000411279.6406" style="pointer-events: auto;">登录</button>
  </form>

<form class="am-form am-form-inline" role="form"><div class="am-form-group"><label for="doc-ipt-3" class="am-u-sm-2 am-form-label">电子邮件</label><div class="am-u-sm-10"><input type="email" id="doc-ipt-3" placeholder="输入你的电子邮件" data-form-un="1516000411278.0627"></div></div>
  <div class="am-form-group">
    <label for="doc-ipt-pwd-2" class="am-u-sm-2 am-form-label">密码</label>
    <div class="am-u-sm-10">
      <input type="password" id="doc-ipt-pwd-2" placeholder="设置一个密码吧" data-form-pw="1516000411278.0627"></div>
    </div><div class="am-form-group">
      <div class="am-u-sm-offset-2 am-u-sm-10">
        <div class="checkbox">
          <label><input type="checkbox"> 记住十万年</label>
        </div>
      </div>
    </div>
    <div class="am-form-group">
      <div class="am-u-sm-10 am-u-sm-offset-2">
        <button type="submit" class="am-btn am-btn-default" data-form-sbm="1516000411278.0627" style="pointer-events: auto;">提交登入</button>
      </div>
    </div>
  </form>
-->
    <!--
      <div class="form-tip-group">
        <div class="form-tip">
          <div class="form-tip-border"> <span class="iconfont icon-tuodong"></span>
          请从菜单拖拽面板控件到此
          </div>
        </div>
      </div>
    -->
    </div>


    <div id="js-formOptionPlane" class="formOptionPlane">
      <ul class="am-nav am-nav-tabs">
        <li class="am-active"><a href="#">控件属性</a></li>
        <li><a href="#">验证属性</a></li>
        <li><a class="form-unclick" disabled="true" href="#">数据源</a></li>
        <li><a class="form-unclick" disabled="true" href="#">自定义属性</a></li>
      </ul>
      <div class="option-content">

        <form class="am-form-option">
          <div class="item-option-colum">
              <label>name:</label>
              <input  type="email"   class="am-form-field" placeholder="name属性" data-form-un="1516000411279.6406">
          </div>

          <div class="item-option-colum">
              <label>placeholder:</label>
              <input  type="email"  class="am-form-field" placeholder="placeholder属性" data-form-un="1516000411279.6406">
          </div>

          <div class="item-option-colum">
              <label>type:</label>
              <select>
                <option value="">text</option>
                <option value="">number</option>
                <option value="">email</option>
                <option value="">number</option>
              </select>
          </div>
        </form>

        <div style="text-align:center; margin-top:2em;" id="js-formOptionSave">
            <button type="button" class="am-btn am-btn-primary am-radius am-btn-block">修改</button>
        </div>
      </div>
        <!--
        <h4>验证属性</h4>
        <hr></hr>

        <h4>数据源</h4>
        <hr></hr>

        <h4>自定义属性</h4>
        <hr></hr>
        -->

    </div>
  </div>


  <footer class="admin-content-footer">
    <hr>
    <p class="am-padding-left">© 2018 表单生成器.</p>
  </footer>

</div>

</div>

<a href="#"  class="am-icon-btn am-icon-th-list am-show-sm-only admin-menu" data-am-offcanvas="{target: '#admin-offcanvas'}"></a>



<footer>
  <hr>
  <p class="am-padding-left">© 2018 表单生成器.</p>
</footer>



<!--
<script src="ui/assets/js/jquery.min.js"></script>

<script src="ui/assets/js/amazeui.min.js"></script>
<script src="ui/assets/js/app.js"></script>
-->

<script src="scripts/vue/vue.js"></script>
<script src="scripts/requirejs/require.js"></script>

<script type="text/javascript">


/*
var customScroll = new scrollbot("#js-formDragPlane");
customScroll.setStyle({
  'background':'#000',
  'border-radius':'20px'
},{
  'background':'#fff',
  'opacity':'.5'
})
*/

var layout={
  itemSelect:"iphone 6 Plus",
  layoutStyle:{},
  defaultDom:"",
  currentSize:{
    width:414,
    height:736
  },
  layoutItems:{
    "iphone 5":{
      width:320,
      height:560
    },
    "iphone 6":{
      width:375,
      height:667
    },
    "iphone 6 Plus":{
      width:414,
      height:736
    },
    "iPad":{
      width:768,
      height:1024
    }
  }
}


var dropEventBus={
  dragStart:function(e){
    console.log("开始拖拽",e);
    e.dataTransfer.setData("Text","hellow");
  },
  dragOver:function(e){
    console.clear();
    console.log("拖拽中",e);
    e.preventDefault();
  },
  dragEvent:function(e){
    e.preventDefault();
    console.log("拖拽结束",e);
  }
}


/*动态表单上下文对象*/
var formContext=(function(){





})();



/**
 * 表单生成工厂
 * 主要负责生成表单元素，以及
 * @return {[object]} [工厂方法]
 */
var formCreatorFactory=(function(){

    /*错误提示对象*/
    var errorMes={
      "4001":"未知元素",
      "4101":"未能获取要被修改的dom元素"
    }

    /*设置对象的attr属性*/
    var _setAttr=function(option,dom){
      if(option.attr===undefined){
        return;
      }
      for(attrName in option.attr){
        dom.setAttribute(attrName,option.attr[attrName]);
      }
    };

    /*设置拖拽事件*/
    var _setDropEvent=function(dom){
        dom.setAttribute("draggable",true);
        dom.setAttribute("ondragstart","dragStart(event)");
    }

    /*设置控件的唯一ID*/
    var _setOnlyId=function(dom){
        dom.setAttribute("data-controlId","");
    }


    /*创建表单元素*/
    var _create=function(option){
      var wrapDom,formDom;
      if(option.el===undefined){
        throw errorMes["4001"];
      }

      formDom=document.createElement(option.el);
      _setAttr(option,formDom);

      if(option.wrap!==undefined){
          wrapDom=document.createElement(option.wrap);
          wrapDom.appendChild(formDom);
          wrapDom.innerHTML=wrapDom.innerHTML+option.attr.type;
          formDom=wrapDom;
      }

      _setDropEvent(formDom);
      _setOnlyId(formDom);

      return formDom;
    }

    /*获取需要改动的dom元素*/
    var _getChangeDom=function(option){

      var changeDom={
        targetDom:document.getElementById(option.targetId)
      };

      if(option.newDom!==undefined){
          changeDom.formDom=_create(option.newDom);
      }

      else if(option.controlId!==undefined){
          changeDom.formDom=_create(option.newDom);
      }

      if(changeDom.formDom===undefined){
        throw ["4101"];
      }

      return changeDom;
    }

    /*创建表单元素*/
    var createContext=function(option){
        return _create(option);
    }

    /*追加表单元素到目标元素之后*/
    var appendContext=function(option){
        var changeDom=_getChangeDom(option);
        document.insertBefore(formDom,targetDom);
    }

    /*追加元素到目标元素之前*/
    var beforeContext=function(option){
        var changeDom=_getChangeDom(option);
        document.insertAfter(changeDom.formData,changeDom.targetDom);
    }

    return{
      create:createContext,
      append:appendContext,
      before:beforeContext
    }

})(window,document);


/**
 * 表单属性工厂
 * @return {[object]} 属性对象
 */
var formOptionFactory=(function(){
    return{
      update:null
    };

})();


var dom=formCreatorFactory.create({
  title:"单选框",
  el:"input",
  wrap:"label",
  editAttr:{
    dataAttrs:{

    },
    innerText:{

    }
  },
  attr:{
    type:"radio"
  },
  icon:"iconfont icon-danxuankuangxuanzhong",
  enable:true
});

document.getElementById("js-formDragPlane").appendChild(dom);
console.log(dom);


var formMap={
  layout:{
    title:"面板",
    icon:"iconfont icon-novigo_layout",
    enable:true,
    controlMap:
    {
      "row":{
        title:"行面板",
        el:"div",
        attr:{
          class:"item-row"
        },
        icon:"iconfont icon-hang",
        enable:true,
        level:1
      },
      "col":{
        title:"列面板",
        el:"div",
        attr:{
          class:"item-colum",
        },
        icon:"iconfont icon-lie",
        enable:true,
        level:1
      }
    }
  },
  formControl:
  {
    title:"表单",
    icon:"iconfont icon-lingjianxiangqing",
    enable:true,
    controlMap:{
      "input":{
        title:"文本框",
        el:"input",
        attr:{
          type:"text"
        },
        icon:"iconfont icon-lingjianxiangqing",
        enable:true,
        level:2
      },
      "radio":{
        title:"单选框",
        el:"input",
        wrap:"label",
        attr:{
          type:"radio"
        },
        icon:"iconfont icon-danxuankuangxuanzhong",
        enable:true,
        level:2
      },
      "checkbox":{
        title:"多选框",
        el:"input",
        wrap:"label",
        attr:{
          type:"checkbox"
        },
        icon:"iconfont icon-icon192",
        enable:true,
        level:2
      },
      "select":{
        title:"下拉框",
        el:"select",
        icon:"iconfont icon-xialakuang",
        enable:true,
        level:2
      },
      "timepicket":{
        title:"时间选择",
        el:"input",
        icon:"iconfont icon-riqixuanze",
        enable:true,
        level:2
      },
      "multiline":{
        title:"多行文本",
        el:"textarea",
        icon:"iconfont icon-kongjian-duohangshurukuang",
        enable:true,
        level:2
      },
      "file":{
        title:"文件上传",
        el:"textarea",
        attr:{
          type:"file"
        },
        icon:"iconfont icon-uploadPic",
        enable:true,
        level:2
      },
      "submit":{
        title:"提交",
        el:"input",
        attr:{
          type:"submit"
        },
        icon:"iconfont icon-anniu",
        enable:true,
        level:2
      },
      "button":{
        title:"按钮",
        el:"input",
        attr:{
          type:"button"
        },
        icon:"iconfont icon-anniu",
        enable:true,
        level:2
      }

    }
  }
}

  new Vue({
    el:"#autoForm",
    data:{
      formMap:formMap,
      layout:layout,
      layoutStyle:{}
    },
    methods:{
      layoutChange:function(event){
        var layoutVal=event.target.value;
        var layoutObj=this.layout.layoutItems[layoutVal];

        this.layoutStyle={
          width:layoutObj.width+"px",
          height:layoutObj.height+"px"
        };

        _objMapTo(this.layout.currentSize,layoutObj);

      }
    }
  });



  function _objMapTo(targetObj,mapObj) {
    for(var key in  targetObj){
      targetObj[key]=mapObj[key];
    }
    return targetObj;
  }




</script>


</body>
</html>
